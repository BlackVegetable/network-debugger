
# Hello, this is a comment.

##
   #

start variables
    shiva "Questionable"
    jerry = "cool"
    xkcd "@#%!@"

    # Numbers now
    x = 1
    dx 5
    blagga -14

    favorite_protocol = "UDP"

start state initialState

# No arguments yet
define state initialState
    matching
        match_string("UDP", "dport", "53")
        or match_string(favorite_protocol, "dport", dx)
        or match_string("UDP", "sport", "12")
    compare
        5 < 6
        "Hello" == "Hello"
    do
        set(favorite_protocol, "TCP")
        inc(blagga)
        dec(x)
        print("Got one!")
    goto
        stateWithOnlyTimeout

define state stateWithOnlyTimeout
    timeout
        60
    goto
        stateWithTwoArguments "Hello, I am a carrot!" 42

define state lotsOfPrinting theAnswer
    matching
        match_string("UDP", "dport", "53")
    do
        print(blagga)
        set(blagga, theAnswer)
        print(blagga)
        print(x)
        dec(x)
        dec(x)
        print(x)
    goto
        exit

define state stateWithTwoArguments arg1 arg2
    timeout
        10
    do
        print(arg1)
        print(shiva)
    goto
        stateWithOneArgument arg2

define state stateWithOneArgument arg1
    matching
        match_atleast("IP", "len", 12)
        match_atmost("IP", "len", 45)
        and match_string("UDP", "dport", "53")
        or match_string("UDP", "dport", arg1)
        match_exactly("IP", "len", 33)
    do
        print("I am a print statement! GWAARRR!")
        print_stacktrace()
    goto
        exit
    timeout
        120
    goto
        stateWithOnlyTimeout
